<project name="jbehave-eclipse" default="generate-scripts">
	<target name="generate-scripts">

		<echo>Feature - ${feature}</echo>
		<property name="feature" value="org.jbehave.plugin.eclipse.feature" />
		<property name="elements" value="feature@${feature}" />

		<mkdir dir="build" />
		<eclipse.fetch elements="${elements}" buildDirectory="." directory="directory.txt" fetchTag="COPY" />

		<ant antfile="fetch_${feature}.xml">
			<property name="featureAndPlugins" value="X" />
			<property name="featureOnly" value="X" />
			<property name="buildDirectory" value="build" />
		</ant>

		<xslt extension="properties" style="extract-feature-version.xslt" in="build/features/${feature}/feature.xml" out="version.xml" />
		<xmlproperty file="version.xml" />

		<echo>Using Eclipse Home: ${eclipse.home}</echo>
		<eclipse.buildScript elements="${elements}" children="true" buildDirectory="build" baseLocation="${eclipse.home}" />
		<mkdir dir="build/site/features" />
		<mkdir dir="build/site/plugins" />


		<ant dir="build/features/${feature}" antfile="build.xml" target="build.update.jar">
			<property name="feature.destination" value="../../site/features" />
			<property name="plugin.destination" value="../../site/plugins" />
		</ant>

		<ant dir="build/features/${feature}" antfile="build.xml" target="zip.distribution" />
		<!--<ant antfile="build/assemble.${feature}.all.xml"/> -->

		<xslt style="site.xslt" in="version.xml" out="build/site/site.xml" />

	</target>
</project>


